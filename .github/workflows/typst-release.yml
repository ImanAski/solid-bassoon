# .github/workflows/typst-release.yml

name: Generate Typst PDF and Upload to Release

# Trigger this workflow when a new release is published
on:
  release:
    types: [published]

jobs:
  build-and-upload:
    runs-on: ubuntu-latest
    # Set permissions for the GITHUB_TOKEN to allow uploading to the release
    permissions:
      contents: write

    steps:
      # Step 1: Check out the repository content
      - name: Checkout repository
        uses: actions/checkout@v4

      # Step 2: Compile the Typst file to a PDF
      - name: Compile Typst file
        # Uses the official Typst action
        uses: typst-actions/typst-action@v3
        with:
          # The main Typst file to compile. Change this if your file has a different name.
          source_file: main.typ
          # The name of the output PDF file.
          output_file: output/document.pdf

      # Step 3: Upload the generated PDF to the release
      - name: Upload PDF to Release
        # Uses the official GitHub action for managing releases
        uses: softprops/action-gh-release@v1
        with:
          # The path to the file(s) to upload. This can be a glob pattern.
          files: output/document.pdf
